(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[604],{5923:(e,t,a)=>{Promise.resolve().then(a.bind(a,3468))},3468:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>x});var l=a(5155),s=a(2266),i=a(2115),n=a(8212),r=a(2592);let d=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,[a,l]=(0,i.useState)(null);return(0,i.useEffect)(()=>{let a=setTimeout(()=>l(e),t);return()=>{clearTimeout(a)}},[e,t]),a},c=()=>{let[e,t]=(0,i.useState)([]),[a,l]=(0,i.useState)([]),[s,c]=(0,i.useState)(!0),[o,u]=(0,i.useState)(""),[h,m]=(0,i.useState)(""),[x,p]=(0,i.useState)(0),v=d(e),{updateCart:b,removeFromCart:f,verifyCart:g}=(0,n._)(),j=(0,i.useCallback)(e=>u(e.target.value),[]),y=(0,i.useCallback)(async(e,t)=>{"success"===(await (await fetch("https://api.noderent.pro/cart/checkout",{method:"POST",body:JSON.stringify({items:e.map(e=>({id:e.id,qt:e.quantity,duration_month:e.duration})),promocode:t}),credentials:"include"})).json()).status?alert("success"):alert("Something went wrong, try again later")},[]),N=(0,i.useCallback)(()=>{v&&y(v,h)},[v,h]),C=(0,i.useCallback)(async()=>{let e=await (await fetch("https://api.noderent.pro/nodes",{method:"GET",credentials:"include"})).json();"success"===e.status&&l(Object.values(e.active))},[]),w=(0,i.useCallback)(async(e,t)=>{let a=await (await fetch("https://api.noderent.pro/cart/calculateTotal",{method:"POST",body:JSON.stringify({items:e.map(e=>({id:e.id,qt:e.quantity,duration_month:e.duration})),promocode:t}),credentials:"include"})).json();"success"===a.status&&p(a.cart_total)},[]),k=(0,i.useCallback)(()=>{u(""),m("")},[]),S=(0,i.useCallback)(async()=>{"success"===(await (await fetch("https://api.noderent.pro/promocode",{method:"POST",body:JSON.stringify({promocode:o}),credentials:"include"})).json()).status?(c(!0),m(o)):c(!1)},[o,e]),P=(0,i.useCallback)(e=>{let l=f(e);t(l=(0,r.ze)(l,a))},[f,a]),_=(0,i.useCallback)(function(){for(var e=arguments.length,l=Array(e),s=0;s<e;s++)l[s]=arguments[s];let i=b(...l);t(i=(0,r.ze)(i,a))},[b,a]);return(0,i.useEffect)(()=>{C(),t((0,r.Xl)())},[]),(0,i.useEffect)(()=>{v&&w(v,h)},[v,h]),(0,i.useEffect)(()=>{if(v&&v.length){let e=v;t(e=(0,r.ze)(e,a))}},[v]),(0,i.useEffect)(()=>{if(!a.length)return;g(a);let e=(0,r.Xl)();t(e=(0,r.ze)(e,a))},[a,g]),{cartData:e,cartTotal:x,removeFromCart:P,updateCart:_,isPromocodeValid:s,promocode:o,handlePromocodeChange:j,removePromocode:k,checkPromocode:S,checkout:N}},o=e=>{let{id:t,initialQuantity:a,initialDuration:l,update:s,remove:n}=e,[r,d]=(0,i.useState)(a),[c,o]=(0,i.useState)(l);return{handleRemoveFromCart:(0,i.useCallback)(()=>n(t),[n,t]),quantity:r,duration:c,onChangeQuantity:(0,i.useCallback)(e=>{d(e.target.value),s(t,+e.target.value)},[s,t]),onChangeDuration:(0,i.useCallback)(e=>{o(e.target.value),s(t,void 0,+e.target.value)},[s,t])}};var u=a(3996);let h=e=>{let{item:t,update:a,remove:s}=e,{handleRemoveFromCart:i,duration:n,quantity:r,onChangeQuantity:d,onChangeDuration:c}=o({id:t.id,initialQuantity:t.quantity,initialDuration:t.duration,update:a,remove:s});return(0,l.jsxs)("tr",{className:"h-14 border-b border-midnight-900",children:[(0,l.jsx)("td",{className:"px-4",children:t.name}),(0,l.jsxs)("td",{className:"px-4",children:["$",t.monthly]}),(0,l.jsxs)("td",{className:"px-4",children:["$",t.installation_price]}),(0,l.jsx)("td",{className:"px-4",children:(0,l.jsx)(u.p,{size:"s",value:r,type:"number",onChange:d})}),(0,l.jsx)("td",{className:"px-4",children:(0,l.jsx)(u.p,{size:"s",value:n,type:"number",onChange:c})}),(0,l.jsx)("td",{className:"px-4",children:(0,l.jsx)("button",{className:"border border-midnight-950 p-2 rounded-lg",onClick:i,children:(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 -960 960 960",width:"24px",fill:"#e3e3e3",children:(0,l.jsx)("path",{d:"M280-120q-33 0-56.5-23.5T200-200v-520h-40v-80h200v-40h240v40h200v80h-40v520q0 33-23.5 56.5T680-120H280Zm400-600H280v520h400v-520ZM360-280h80v-360h-80v360Zm160 0h80v-360h-80v360ZM280-720v520-520Z"})})})})]})},m=e=>{let{data:t,update:a,remove:s}=e;return(0,l.jsx)(l.Fragment,{children:t.length>0?(0,l.jsx)("div",{className:"border border-midnight-900 rounded-lg overflow-x-auto",children:(0,l.jsxs)("table",{className:"w-full text-left",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{className:"h-14 border-b border-midnight-900",children:[(0,l.jsx)("th",{className:"px-4",children:"Name"}),(0,l.jsx)("th",{className:"px-4",children:"Per month"}),(0,l.jsx)("th",{className:"px-4",children:"Installation price"}),(0,l.jsx)("th",{className:"px-4",children:"Quantity"}),(0,l.jsx)("th",{className:"px-4",children:"Duration (months)"}),(0,l.jsx)("th",{})]})}),(0,l.jsx)("tbody",{children:t.map((e,t)=>(0,l.jsx)(h,{item:e,update:a,remove:s},t))})]})}):(0,l.jsx)("span",{className:"text-center mt-10 text-xl font-semibold",children:"Your cart is empty"})})};function x(){let{cartData:e,cartTotal:t,updateCart:a,removeFromCart:i,isPromocodeValid:n,promocode:r,handlePromocodeChange:d,removePromocode:o,checkPromocode:h,checkout:x}=c();return(0,l.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,l.jsx)("h2",{className:"text-2xl font-bold flex justify-center m-4",children:"Cart"}),(0,l.jsx)(m,{data:e,update:a,remove:i}),(0,l.jsxs)("div",{className:"flex flex-col items-end gap-2",children:[(0,l.jsx)(u.p,{value:r,onChange:d,label:"Promocode"}),!n&&(0,l.jsx)("span",{className:"text-red-600",children:"promocode invalid"}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)(s.$,{onClick:o,children:"Remove"}),(0,l.jsx)(s.$,{onClick:h,children:"Apply"})]})]}),(0,l.jsxs)("div",{className:"flex justify-end mt-4",children:["Total: $",t]}),(0,l.jsx)(s.$,{size:"l",positon:"right",onClick:x,children:"Proceed to checkout"})]})}},2072:(e,t,a)=>{"use strict";a.d(t,{P:()=>l});let l="cart"},2592:(e,t,a)=>{"use strict";a.d(t,{Xl:()=>i,po:()=>s,ze:()=>n});var l=a(2072);let s=(e,t)=>{localStorage.setItem(e,JSON.stringify(t)),window.dispatchEvent(new Event("storage"))},i=()=>JSON.parse(localStorage.getItem(l.P)||"[]"),n=(e,t)=>{for(let a=0;a<e.length;a++){let l=t.find(t=>t.id===e[a].id);e[a]={...e[a],id:null==l?void 0:l.id,name:null==l?void 0:l.name,monthly:null==l?void 0:l.monthly,installation_price:null==l?void 0:l.installation_price}}return e}},8212:(e,t,a)=>{"use strict";a.d(t,{_:()=>n});var l=a(2115),s=a(2592),i=a(2072);let n=()=>{let e=(0,l.useCallback)(e=>{let t=(0,s.Xl)(),a=t.find(t=>t.id===e);t=a?[...t.filter(t=>t.id!==e),{id:e,quantity:a.quantity+1,duration:1}]:[...t,{id:e,quantity:1,duration:1}],(0,s.po)(i.P,t)},[]),t=(0,l.useCallback)((e,t,a)=>{let l=(0,s.Xl)(),n=l.findIndex(t=>t.id===e);return l[n]={...l[n],id:l[n].id,quantity:t||l[n].quantity,duration:a||l[n].duration},(0,s.po)(i.P,l),l},[]),a=(0,l.useCallback)(e=>{let t=(0,s.Xl)().filter(t=>t.id!==e);return(0,s.po)(i.P,t),t},[]),n=(0,l.useCallback)(e=>{let t=(0,s.Xl)();if(!t.length||!e.length)return;let a=t.filter(t=>e.findIndex(e=>e.id===t.id)>=0);(0,s.po)(i.P,a)},[]);return{CART:i.P,addToCart:e,updateCart:t,removeFromCart:a,verifyCart:n}}},2266:(e,t,a)=>{"use strict";a.d(t,{$:()=>i});var l=a(5155);let s=(0,a(7782).tv)({base:"font-medium text-center",variants:{color:{primary:"rounded-lg bg-blue-600 active:bg-white active:text-black disabled:bg-blue-900 disabled:text-gray-500",link:"text-blue-500 active:text-blue-300 hover:text-blue-400",google:"rounded-lg bg-white text-black"},size:{m:"px-4 py-1 w-40 max-w-full",l:"px-4 py-1 w-60",xl:"px-4 py-2 w-full"},positon:{center:"self-center",right:"self-end"}},defaultVariants:{color:"primary",size:"m"}}),i=e=>{let{children:t,variant:a,size:i,positon:n,...r}=e;return(0,l.jsx)("button",{className:s({color:a,size:i,positon:n}),...r,children:t})}},3996:(e,t,a)=>{"use strict";a.d(t,{p:()=>i});var l=a(5155);let s=(0,a(7782).tv)({base:"rounded-lg bg-midnight-800 border-midnight-950 border focus:border-blue-500 focus:outline-0 invalid:text-red-500 invalid:border-red-500",variants:{size:{s:"min-h-8 max-w-12 px-2",m:"min-h-12 px-4"}},defaultVariants:{color:"primary",size:"m"}}),i=e=>{let{label:t,size:a,...i}=e;return(0,l.jsxs)("div",{className:"flex flex-col gap-2",children:[t&&(0,l.jsx)("label",{className:"font-medium text-left",htmlFor:t,children:t}),(0,l.jsx)("input",{className:s({size:a}),...i,id:t,name:t})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[782,441,517,358],()=>t(5923)),_N_E=e.O()}]);