(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[604],{5923:(e,t,a)=>{Promise.resolve().then(a.bind(a,3468))},3468:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>x});var l=a(5155),s=a(2266),r=a(2115),i=a(8212),n=a(2592);let d=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,[a,l]=(0,r.useState)(null);return(0,r.useEffect)(()=>{let a=setTimeout(()=>l(e),t);return()=>{clearTimeout(a)}},[e,t]),a},o=()=>{let[e,t]=(0,r.useState)([]),[a,l]=(0,r.useState)([]),[s,o]=(0,r.useState)(!0),[c,u]=(0,r.useState)(""),[h,m]=(0,r.useState)(""),[x,p]=(0,r.useState)(0),b=d(e),{updateCart:g,removeFromCart:v,verifyCart:f}=(0,i._)(),j=(0,r.useCallback)(e=>u(e.target.value),[]),y=(0,r.useCallback)(async(e,t)=>{let a=await (await fetch("https://api.noderent.pro/cart/checkout",{method:"POST",body:JSON.stringify({items:e.map(e=>({id:e.id,qt:e.quantity,duration_month:e.duration})),promocode:t}),credentials:"include"})).json();"success"===a.status?window.location.href=a.payment_link:alert("Something went wrong, try again later")},[]),N=(0,r.useCallback)(()=>{b&&y(b,h)},[b,h]),w=(0,r.useCallback)(async()=>{let e=await (await fetch("https://api.noderent.pro/nodes",{method:"GET",credentials:"include"})).json();"success"===e.status&&l(Object.values(e.active))},[]),C=(0,r.useCallback)(async(e,t)=>{let a=await (await fetch("https://api.noderent.pro/cart/calculateTotal",{method:"POST",body:JSON.stringify({items:e.map(e=>({id:e.id,qt:e.quantity,duration_month:e.duration})),promocode:t}),credentials:"include"})).json();"success"===a.status&&p(a.cart_total)},[]),k=(0,r.useCallback)(()=>{u(""),m("")},[]),S=(0,r.useCallback)(async()=>{"success"===(await (await fetch("https://api.noderent.pro/promocode",{method:"POST",body:JSON.stringify({promocode:c}),credentials:"include"})).json()).status?(o(!0),m(c)):o(!1)},[c,e]),_=(0,r.useCallback)(e=>{let l=v(e);t(l=(0,n.ze)(l,a))},[v,a]),P=(0,r.useCallback)(function(){for(var e=arguments.length,l=Array(e),s=0;s<e;s++)l[s]=arguments[s];let r=g(...l);t(r=(0,n.ze)(r,a))},[g,a]);return(0,r.useEffect)(()=>{w(),t((0,n.Xl)())},[]),(0,r.useEffect)(()=>{b&&C(b,h)},[b,h]),(0,r.useEffect)(()=>{if(b&&b.length){let e=b;t(e=(0,n.ze)(e,a))}},[b]),(0,r.useEffect)(()=>{if(!a.length)return;f(a);let e=(0,n.Xl)();t(e=(0,n.ze)(e,a))},[a,f]),{cartData:e,cartTotal:x,removeFromCart:_,updateCart:P,isPromocodeValid:s,promocode:c,handlePromocodeChange:j,removePromocode:k,checkPromocode:S,checkout:N}},c=e=>{let{id:t,initialQuantity:a,initialDuration:l,update:s,remove:i}=e,[n,d]=(0,r.useState)(a),[o,c]=(0,r.useState)(l);return{handleRemoveFromCart:(0,r.useCallback)(()=>i(t),[i,t]),quantity:n,duration:o,onChangeQuantity:(0,r.useCallback)(e=>{d(e.target.value),s(t,+e.target.value)},[s,t]),onChangeDuration:(0,r.useCallback)(e=>{c(e.target.value),s(t,void 0,+e.target.value)},[s,t])}};var u=a(3996);let h=e=>{let{item:t,update:a,remove:s}=e,{handleRemoveFromCart:r,duration:i,quantity:n,onChangeQuantity:d,onChangeDuration:o}=c({id:t.id,initialQuantity:t.quantity,initialDuration:t.duration,update:a,remove:s});return(0,l.jsxs)("tr",{className:"h-14 border-b border-midnight-900",children:[(0,l.jsx)("td",{className:"px-4",children:t.name}),(0,l.jsxs)("td",{className:"px-4",children:["$",t.monthly]}),(0,l.jsxs)("td",{className:"px-4",children:["$",t.installation_price]}),(0,l.jsx)("td",{className:"px-4",children:(0,l.jsx)(u.p,{size:"s",value:n,type:"number",onChange:d})}),(0,l.jsx)("td",{className:"px-4",children:(0,l.jsx)(u.p,{size:"s",value:i,type:"number",onChange:o})}),(0,l.jsx)("td",{className:"px-4",children:(0,l.jsx)("button",{className:"border border-midnight-950 p-2 rounded-lg",onClick:r,children:(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 -960 960 960",width:"24px",fill:"#e3e3e3",children:(0,l.jsx)("path",{d:"M280-120q-33 0-56.5-23.5T200-200v-520h-40v-80h200v-40h240v40h200v80h-40v520q0 33-23.5 56.5T680-120H280Zm400-600H280v520h400v-520ZM360-280h80v-360h-80v360Zm160 0h80v-360h-80v360ZM280-720v520-520Z"})})})})]})},m=e=>{let{data:t,update:a,remove:s}=e;return(0,l.jsx)(l.Fragment,{children:t.length>0?(0,l.jsx)("div",{className:"border border-midnight-900 rounded-lg overflow-x-auto",children:(0,l.jsxs)("table",{className:"w-full text-left",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{className:"h-14 border-b border-midnight-900",children:[(0,l.jsx)("th",{className:"px-4",children:"Name"}),(0,l.jsx)("th",{className:"px-4",children:"Per month"}),(0,l.jsx)("th",{className:"px-4",children:"Installation price"}),(0,l.jsx)("th",{className:"px-4",children:"Quantity"}),(0,l.jsx)("th",{className:"px-4",children:"Duration (months)"}),(0,l.jsx)("th",{})]})}),(0,l.jsx)("tbody",{children:t.map((e,t)=>(0,l.jsx)(h,{item:e,update:a,remove:s},t))})]})}):(0,l.jsx)("span",{className:"text-center mt-10 text-xl font-semibold",children:"Your cart is empty"})})};function x(){let{cartData:e,cartTotal:t,updateCart:a,removeFromCart:r,isPromocodeValid:i,promocode:n,handlePromocodeChange:d,removePromocode:c,checkPromocode:h,checkout:x}=o();return(0,l.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,l.jsx)("h2",{className:"text-2xl font-bold flex justify-center m-4",children:"Cart"}),(0,l.jsx)(m,{data:e,update:a,remove:r}),(0,l.jsxs)("div",{className:"flex flex-col items-end gap-2",children:[(0,l.jsx)(u.p,{value:n,onChange:d,label:"Promocode"}),!i&&(0,l.jsx)("span",{className:"text-red-600",children:"promocode invalid"}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)(s.$,{onClick:c,children:"Remove"}),(0,l.jsx)(s.$,{onClick:h,children:"Apply"})]})]}),(0,l.jsxs)("div",{className:"flex justify-end mt-4",children:["Total: $",t]}),(0,l.jsx)(s.$,{size:"l",positon:"right",onClick:x,children:"Proceed to checkout"})]})}},2072:(e,t,a)=>{"use strict";a.d(t,{P:()=>l});let l="cart"},2592:(e,t,a)=>{"use strict";a.d(t,{Xl:()=>r,po:()=>s,ze:()=>i});var l=a(2072);let s=(e,t)=>{localStorage.setItem(e,JSON.stringify(t)),window.dispatchEvent(new Event("storage"))},r=()=>JSON.parse(localStorage.getItem(l.P)||"[]"),i=(e,t)=>{for(let a=0;a<e.length;a++){let l=t.find(t=>t.id===e[a].id);e[a]={...e[a],id:null==l?void 0:l.id,name:null==l?void 0:l.name,monthly:null==l?void 0:l.monthly,installation_price:null==l?void 0:l.installation_price}}return e}},8212:(e,t,a)=>{"use strict";a.d(t,{_:()=>i});var l=a(2115),s=a(2592),r=a(2072);let i=()=>{let e=(0,l.useCallback)(e=>{let t=(0,s.Xl)(),a=t.find(t=>t.id===e);t=a?[...t.filter(t=>t.id!==e),{id:e,quantity:a.quantity+1,duration:1}]:[...t,{id:e,quantity:1,duration:1}],(0,s.po)(r.P,t)},[]),t=(0,l.useCallback)((e,t,a)=>{let l=(0,s.Xl)(),i=l.findIndex(t=>t.id===e);return l[i]={...l[i],id:l[i].id,quantity:t||l[i].quantity,duration:a||l[i].duration},(0,s.po)(r.P,l),l},[]),a=(0,l.useCallback)(e=>{let t=(0,s.Xl)().filter(t=>t.id!==e);return(0,s.po)(r.P,t),t},[]),i=(0,l.useCallback)(e=>{let t=(0,s.Xl)();if(!t.length||!e.length)return;let a=t.filter(t=>e.findIndex(e=>e.id===t.id)>=0);(0,s.po)(r.P,a)},[]);return{CART:r.P,addToCart:e,updateCart:t,removeFromCart:a,verifyCart:i}}},2266:(e,t,a)=>{"use strict";a.d(t,{$:()=>r});var l=a(5155);let s=(0,a(7782).tv)({base:"font-medium text-center",variants:{color:{primary:"rounded-lg bg-blue-600 active:bg-white active:text-black enabled:hover:bg-blue-500 disabled:bg-blue-900 disabled:text-gray-500",link:"text-blue-500 active:text-blue-300 hover:text-blue-400",google:"rounded-lg bg-white text-black",ghost:"rounded-lg border border-midnight-950 hover:border-blue-400",highlightedGhost:"rounded-3xl border border-gray-400 enabled:hover:border-blue-400 disabled:text-gray-400 disabled:border-gray-600"},size:{unset:"px-4",m:"px-4 w-40 max-w-full",l:"px-4 w-60",xl:"px-4 w-full"},height:{m:"py-1",l:"py-2.5"},positon:{center:"self-center",right:"self-end"}},defaultVariants:{color:"primary",size:"m",height:"m"}}),r=e=>{let{children:t,variant:a,size:r,height:i,positon:n,...d}=e;return(0,l.jsx)("button",{className:s({color:a,size:r,height:i,positon:n}),...d,children:t})}},3996:(e,t,a)=>{"use strict";a.d(t,{p:()=>r});var l=a(5155);let s=(0,a(7782).tv)({base:"rounded-lg bg-midnight-800 border-midnight-950 border focus:border-blue-500 focus:outline-0 invalid:text-red-500 invalid:border-red-500",variants:{size:{s:"min-h-8 max-w-12 px-2",m:"min-h-12 px-4"}},defaultVariants:{color:"primary",size:"m"}}),r=e=>{let{label:t,size:a,...r}=e;return(0,l.jsxs)("div",{className:"flex flex-col gap-2",children:[t&&(0,l.jsx)("label",{className:"font-medium text-left",htmlFor:t,children:t}),(0,l.jsx)("input",{className:s({size:a}),...r,id:t,name:t})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[782,441,517,358],()=>t(5923)),_N_E=e.O()}]);